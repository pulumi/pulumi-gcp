// Code generated by the Pulumi Terraform Bridge (tfgen) Tool DO NOT EDIT.
// *** WARNING: Do not edit by hand unless you're certain you know what you are doing! ***

package dataloss

import (
	"context"
	"reflect"

	"errors"
	"github.com/pulumi/pulumi-gcp/sdk/v7/go/gcp/internal"
	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
)

// Configuration for discovery to scan resources for profile generation. Only one discovery configuration may exist per organization, folder, or project.
//
// To get more information about DiscoveryConfig, see:
//
// * [API documentation](https://cloud.google.com/dlp/docs/reference/rest/v2/projects.locations.discoveryConfigs)
// * How-to Guides
//   - [Schedule inspection scan](https://cloud.google.com/dlp/docs/schedule-inspection-scan)
//
// ## Example Usage
//
// ## Import
//
// DiscoveryConfig can be imported using any of these accepted formats:
//
// * `{{parent}}/discoveryConfigs/{{name}}`
//
// * `{{parent}}/{{name}}`
//
// When using the `pulumi import` command, DiscoveryConfig can be imported using one of the formats above. For example:
//
// ```sh
// $ pulumi import gcp:dataloss/preventionDiscoveryConfig:PreventionDiscoveryConfig default {{parent}}/discoveryConfigs/{{name}}
// ```
//
// ```sh
// $ pulumi import gcp:dataloss/preventionDiscoveryConfig:PreventionDiscoveryConfig default {{parent}}/{{name}}
// ```
type PreventionDiscoveryConfig struct {
	pulumi.CustomResourceState

	// Actions to execute at the completion of scanning
	// Structure is documented below.
	Actions PreventionDiscoveryConfigActionArrayOutput `pulumi:"actions"`
	// Output only. The creation timestamp of a DiscoveryConfig.
	CreateTime pulumi.StringOutput `pulumi:"createTime"`
	// Display Name (max 1000 Chars)
	DisplayName pulumi.StringPtrOutput `pulumi:"displayName"`
	// Output only. A stream of errors encountered when the config was activated. Repeated errors may result in the config automatically being paused. Output only field. Will return the last 100 errors. Whenever the config is modified this list will be cleared.
	// Structure is documented below.
	Errors PreventionDiscoveryConfigErrorArrayOutput `pulumi:"errors"`
	// Detection logic for profile generation
	InspectTemplates pulumi.StringArrayOutput `pulumi:"inspectTemplates"`
	// Output only. The timestamp of the last time this config was executed
	LastRunTime pulumi.StringOutput `pulumi:"lastRunTime"`
	// Location to create the discovery config in.
	//
	// ***
	Location pulumi.StringOutput `pulumi:"location"`
	// Unique resource name for the DiscoveryConfig, assigned by the service when the DiscoveryConfig is created.
	Name pulumi.StringOutput `pulumi:"name"`
	// A nested object resource
	// Structure is documented below.
	OrgConfig PreventionDiscoveryConfigOrgConfigPtrOutput `pulumi:"orgConfig"`
	// The parent of the discovery config in any of the following formats:
	// * `projects/{{project}}/locations/{{location}}`
	// * `organizations/{{organization_id}}/locations/{{location}}`
	Parent pulumi.StringOutput `pulumi:"parent"`
	// Required. A status for this configuration
	// Possible values are: `RUNNING`, `PAUSED`.
	Status pulumi.StringPtrOutput `pulumi:"status"`
	// Target to match against for determining what to scan and how frequently
	// Structure is documented below.
	Targets PreventionDiscoveryConfigTargetArrayOutput `pulumi:"targets"`
	// Output only. The last update timestamp of a DiscoveryConfig.
	UpdateTime pulumi.StringOutput `pulumi:"updateTime"`
}

// NewPreventionDiscoveryConfig registers a new resource with the given unique name, arguments, and options.
func NewPreventionDiscoveryConfig(ctx *pulumi.Context,
	name string, args *PreventionDiscoveryConfigArgs, opts ...pulumi.ResourceOption) (*PreventionDiscoveryConfig, error) {
	if args == nil {
		return nil, errors.New("missing one or more required arguments")
	}

	if args.Location == nil {
		return nil, errors.New("invalid value for required argument 'Location'")
	}
	if args.Parent == nil {
		return nil, errors.New("invalid value for required argument 'Parent'")
	}
	opts = internal.PkgResourceDefaultOpts(opts)
	var resource PreventionDiscoveryConfig
	err := ctx.RegisterResource("gcp:dataloss/preventionDiscoveryConfig:PreventionDiscoveryConfig", name, args, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// GetPreventionDiscoveryConfig gets an existing PreventionDiscoveryConfig resource's state with the given name, ID, and optional
// state properties that are used to uniquely qualify the lookup (nil if not required).
func GetPreventionDiscoveryConfig(ctx *pulumi.Context,
	name string, id pulumi.IDInput, state *PreventionDiscoveryConfigState, opts ...pulumi.ResourceOption) (*PreventionDiscoveryConfig, error) {
	var resource PreventionDiscoveryConfig
	err := ctx.ReadResource("gcp:dataloss/preventionDiscoveryConfig:PreventionDiscoveryConfig", name, id, state, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// Input properties used for looking up and filtering PreventionDiscoveryConfig resources.
type preventionDiscoveryConfigState struct {
	// Actions to execute at the completion of scanning
	// Structure is documented below.
	Actions []PreventionDiscoveryConfigAction `pulumi:"actions"`
	// Output only. The creation timestamp of a DiscoveryConfig.
	CreateTime *string `pulumi:"createTime"`
	// Display Name (max 1000 Chars)
	DisplayName *string `pulumi:"displayName"`
	// Output only. A stream of errors encountered when the config was activated. Repeated errors may result in the config automatically being paused. Output only field. Will return the last 100 errors. Whenever the config is modified this list will be cleared.
	// Structure is documented below.
	Errors []PreventionDiscoveryConfigError `pulumi:"errors"`
	// Detection logic for profile generation
	InspectTemplates []string `pulumi:"inspectTemplates"`
	// Output only. The timestamp of the last time this config was executed
	LastRunTime *string `pulumi:"lastRunTime"`
	// Location to create the discovery config in.
	//
	// ***
	Location *string `pulumi:"location"`
	// Unique resource name for the DiscoveryConfig, assigned by the service when the DiscoveryConfig is created.
	Name *string `pulumi:"name"`
	// A nested object resource
	// Structure is documented below.
	OrgConfig *PreventionDiscoveryConfigOrgConfig `pulumi:"orgConfig"`
	// The parent of the discovery config in any of the following formats:
	// * `projects/{{project}}/locations/{{location}}`
	// * `organizations/{{organization_id}}/locations/{{location}}`
	Parent *string `pulumi:"parent"`
	// Required. A status for this configuration
	// Possible values are: `RUNNING`, `PAUSED`.
	Status *string `pulumi:"status"`
	// Target to match against for determining what to scan and how frequently
	// Structure is documented below.
	Targets []PreventionDiscoveryConfigTarget `pulumi:"targets"`
	// Output only. The last update timestamp of a DiscoveryConfig.
	UpdateTime *string `pulumi:"updateTime"`
}

type PreventionDiscoveryConfigState struct {
	// Actions to execute at the completion of scanning
	// Structure is documented below.
	Actions PreventionDiscoveryConfigActionArrayInput
	// Output only. The creation timestamp of a DiscoveryConfig.
	CreateTime pulumi.StringPtrInput
	// Display Name (max 1000 Chars)
	DisplayName pulumi.StringPtrInput
	// Output only. A stream of errors encountered when the config was activated. Repeated errors may result in the config automatically being paused. Output only field. Will return the last 100 errors. Whenever the config is modified this list will be cleared.
	// Structure is documented below.
	Errors PreventionDiscoveryConfigErrorArrayInput
	// Detection logic for profile generation
	InspectTemplates pulumi.StringArrayInput
	// Output only. The timestamp of the last time this config was executed
	LastRunTime pulumi.StringPtrInput
	// Location to create the discovery config in.
	//
	// ***
	Location pulumi.StringPtrInput
	// Unique resource name for the DiscoveryConfig, assigned by the service when the DiscoveryConfig is created.
	Name pulumi.StringPtrInput
	// A nested object resource
	// Structure is documented below.
	OrgConfig PreventionDiscoveryConfigOrgConfigPtrInput
	// The parent of the discovery config in any of the following formats:
	// * `projects/{{project}}/locations/{{location}}`
	// * `organizations/{{organization_id}}/locations/{{location}}`
	Parent pulumi.StringPtrInput
	// Required. A status for this configuration
	// Possible values are: `RUNNING`, `PAUSED`.
	Status pulumi.StringPtrInput
	// Target to match against for determining what to scan and how frequently
	// Structure is documented below.
	Targets PreventionDiscoveryConfigTargetArrayInput
	// Output only. The last update timestamp of a DiscoveryConfig.
	UpdateTime pulumi.StringPtrInput
}

func (PreventionDiscoveryConfigState) ElementType() reflect.Type {
	return reflect.TypeOf((*preventionDiscoveryConfigState)(nil)).Elem()
}

type preventionDiscoveryConfigArgs struct {
	// Actions to execute at the completion of scanning
	// Structure is documented below.
	Actions []PreventionDiscoveryConfigAction `pulumi:"actions"`
	// Display Name (max 1000 Chars)
	DisplayName *string `pulumi:"displayName"`
	// Detection logic for profile generation
	InspectTemplates []string `pulumi:"inspectTemplates"`
	// Location to create the discovery config in.
	//
	// ***
	Location string `pulumi:"location"`
	// A nested object resource
	// Structure is documented below.
	OrgConfig *PreventionDiscoveryConfigOrgConfig `pulumi:"orgConfig"`
	// The parent of the discovery config in any of the following formats:
	// * `projects/{{project}}/locations/{{location}}`
	// * `organizations/{{organization_id}}/locations/{{location}}`
	Parent string `pulumi:"parent"`
	// Required. A status for this configuration
	// Possible values are: `RUNNING`, `PAUSED`.
	Status *string `pulumi:"status"`
	// Target to match against for determining what to scan and how frequently
	// Structure is documented below.
	Targets []PreventionDiscoveryConfigTarget `pulumi:"targets"`
}

// The set of arguments for constructing a PreventionDiscoveryConfig resource.
type PreventionDiscoveryConfigArgs struct {
	// Actions to execute at the completion of scanning
	// Structure is documented below.
	Actions PreventionDiscoveryConfigActionArrayInput
	// Display Name (max 1000 Chars)
	DisplayName pulumi.StringPtrInput
	// Detection logic for profile generation
	InspectTemplates pulumi.StringArrayInput
	// Location to create the discovery config in.
	//
	// ***
	Location pulumi.StringInput
	// A nested object resource
	// Structure is documented below.
	OrgConfig PreventionDiscoveryConfigOrgConfigPtrInput
	// The parent of the discovery config in any of the following formats:
	// * `projects/{{project}}/locations/{{location}}`
	// * `organizations/{{organization_id}}/locations/{{location}}`
	Parent pulumi.StringInput
	// Required. A status for this configuration
	// Possible values are: `RUNNING`, `PAUSED`.
	Status pulumi.StringPtrInput
	// Target to match against for determining what to scan and how frequently
	// Structure is documented below.
	Targets PreventionDiscoveryConfigTargetArrayInput
}

func (PreventionDiscoveryConfigArgs) ElementType() reflect.Type {
	return reflect.TypeOf((*preventionDiscoveryConfigArgs)(nil)).Elem()
}

type PreventionDiscoveryConfigInput interface {
	pulumi.Input

	ToPreventionDiscoveryConfigOutput() PreventionDiscoveryConfigOutput
	ToPreventionDiscoveryConfigOutputWithContext(ctx context.Context) PreventionDiscoveryConfigOutput
}

func (*PreventionDiscoveryConfig) ElementType() reflect.Type {
	return reflect.TypeOf((**PreventionDiscoveryConfig)(nil)).Elem()
}

func (i *PreventionDiscoveryConfig) ToPreventionDiscoveryConfigOutput() PreventionDiscoveryConfigOutput {
	return i.ToPreventionDiscoveryConfigOutputWithContext(context.Background())
}

func (i *PreventionDiscoveryConfig) ToPreventionDiscoveryConfigOutputWithContext(ctx context.Context) PreventionDiscoveryConfigOutput {
	return pulumi.ToOutputWithContext(ctx, i).(PreventionDiscoveryConfigOutput)
}

// PreventionDiscoveryConfigArrayInput is an input type that accepts PreventionDiscoveryConfigArray and PreventionDiscoveryConfigArrayOutput values.
// You can construct a concrete instance of `PreventionDiscoveryConfigArrayInput` via:
//
//	PreventionDiscoveryConfigArray{ PreventionDiscoveryConfigArgs{...} }
type PreventionDiscoveryConfigArrayInput interface {
	pulumi.Input

	ToPreventionDiscoveryConfigArrayOutput() PreventionDiscoveryConfigArrayOutput
	ToPreventionDiscoveryConfigArrayOutputWithContext(context.Context) PreventionDiscoveryConfigArrayOutput
}

type PreventionDiscoveryConfigArray []PreventionDiscoveryConfigInput

func (PreventionDiscoveryConfigArray) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*PreventionDiscoveryConfig)(nil)).Elem()
}

func (i PreventionDiscoveryConfigArray) ToPreventionDiscoveryConfigArrayOutput() PreventionDiscoveryConfigArrayOutput {
	return i.ToPreventionDiscoveryConfigArrayOutputWithContext(context.Background())
}

func (i PreventionDiscoveryConfigArray) ToPreventionDiscoveryConfigArrayOutputWithContext(ctx context.Context) PreventionDiscoveryConfigArrayOutput {
	return pulumi.ToOutputWithContext(ctx, i).(PreventionDiscoveryConfigArrayOutput)
}

// PreventionDiscoveryConfigMapInput is an input type that accepts PreventionDiscoveryConfigMap and PreventionDiscoveryConfigMapOutput values.
// You can construct a concrete instance of `PreventionDiscoveryConfigMapInput` via:
//
//	PreventionDiscoveryConfigMap{ "key": PreventionDiscoveryConfigArgs{...} }
type PreventionDiscoveryConfigMapInput interface {
	pulumi.Input

	ToPreventionDiscoveryConfigMapOutput() PreventionDiscoveryConfigMapOutput
	ToPreventionDiscoveryConfigMapOutputWithContext(context.Context) PreventionDiscoveryConfigMapOutput
}

type PreventionDiscoveryConfigMap map[string]PreventionDiscoveryConfigInput

func (PreventionDiscoveryConfigMap) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*PreventionDiscoveryConfig)(nil)).Elem()
}

func (i PreventionDiscoveryConfigMap) ToPreventionDiscoveryConfigMapOutput() PreventionDiscoveryConfigMapOutput {
	return i.ToPreventionDiscoveryConfigMapOutputWithContext(context.Background())
}

func (i PreventionDiscoveryConfigMap) ToPreventionDiscoveryConfigMapOutputWithContext(ctx context.Context) PreventionDiscoveryConfigMapOutput {
	return pulumi.ToOutputWithContext(ctx, i).(PreventionDiscoveryConfigMapOutput)
}

type PreventionDiscoveryConfigOutput struct{ *pulumi.OutputState }

func (PreventionDiscoveryConfigOutput) ElementType() reflect.Type {
	return reflect.TypeOf((**PreventionDiscoveryConfig)(nil)).Elem()
}

func (o PreventionDiscoveryConfigOutput) ToPreventionDiscoveryConfigOutput() PreventionDiscoveryConfigOutput {
	return o
}

func (o PreventionDiscoveryConfigOutput) ToPreventionDiscoveryConfigOutputWithContext(ctx context.Context) PreventionDiscoveryConfigOutput {
	return o
}

// Actions to execute at the completion of scanning
// Structure is documented below.
func (o PreventionDiscoveryConfigOutput) Actions() PreventionDiscoveryConfigActionArrayOutput {
	return o.ApplyT(func(v *PreventionDiscoveryConfig) PreventionDiscoveryConfigActionArrayOutput { return v.Actions }).(PreventionDiscoveryConfigActionArrayOutput)
}

// Output only. The creation timestamp of a DiscoveryConfig.
func (o PreventionDiscoveryConfigOutput) CreateTime() pulumi.StringOutput {
	return o.ApplyT(func(v *PreventionDiscoveryConfig) pulumi.StringOutput { return v.CreateTime }).(pulumi.StringOutput)
}

// Display Name (max 1000 Chars)
func (o PreventionDiscoveryConfigOutput) DisplayName() pulumi.StringPtrOutput {
	return o.ApplyT(func(v *PreventionDiscoveryConfig) pulumi.StringPtrOutput { return v.DisplayName }).(pulumi.StringPtrOutput)
}

// Output only. A stream of errors encountered when the config was activated. Repeated errors may result in the config automatically being paused. Output only field. Will return the last 100 errors. Whenever the config is modified this list will be cleared.
// Structure is documented below.
func (o PreventionDiscoveryConfigOutput) Errors() PreventionDiscoveryConfigErrorArrayOutput {
	return o.ApplyT(func(v *PreventionDiscoveryConfig) PreventionDiscoveryConfigErrorArrayOutput { return v.Errors }).(PreventionDiscoveryConfigErrorArrayOutput)
}

// Detection logic for profile generation
func (o PreventionDiscoveryConfigOutput) InspectTemplates() pulumi.StringArrayOutput {
	return o.ApplyT(func(v *PreventionDiscoveryConfig) pulumi.StringArrayOutput { return v.InspectTemplates }).(pulumi.StringArrayOutput)
}

// Output only. The timestamp of the last time this config was executed
func (o PreventionDiscoveryConfigOutput) LastRunTime() pulumi.StringOutput {
	return o.ApplyT(func(v *PreventionDiscoveryConfig) pulumi.StringOutput { return v.LastRunTime }).(pulumi.StringOutput)
}

// Location to create the discovery config in.
//
// ***
func (o PreventionDiscoveryConfigOutput) Location() pulumi.StringOutput {
	return o.ApplyT(func(v *PreventionDiscoveryConfig) pulumi.StringOutput { return v.Location }).(pulumi.StringOutput)
}

// Unique resource name for the DiscoveryConfig, assigned by the service when the DiscoveryConfig is created.
func (o PreventionDiscoveryConfigOutput) Name() pulumi.StringOutput {
	return o.ApplyT(func(v *PreventionDiscoveryConfig) pulumi.StringOutput { return v.Name }).(pulumi.StringOutput)
}

// A nested object resource
// Structure is documented below.
func (o PreventionDiscoveryConfigOutput) OrgConfig() PreventionDiscoveryConfigOrgConfigPtrOutput {
	return o.ApplyT(func(v *PreventionDiscoveryConfig) PreventionDiscoveryConfigOrgConfigPtrOutput { return v.OrgConfig }).(PreventionDiscoveryConfigOrgConfigPtrOutput)
}

// The parent of the discovery config in any of the following formats:
// * `projects/{{project}}/locations/{{location}}`
// * `organizations/{{organization_id}}/locations/{{location}}`
func (o PreventionDiscoveryConfigOutput) Parent() pulumi.StringOutput {
	return o.ApplyT(func(v *PreventionDiscoveryConfig) pulumi.StringOutput { return v.Parent }).(pulumi.StringOutput)
}

// Required. A status for this configuration
// Possible values are: `RUNNING`, `PAUSED`.
func (o PreventionDiscoveryConfigOutput) Status() pulumi.StringPtrOutput {
	return o.ApplyT(func(v *PreventionDiscoveryConfig) pulumi.StringPtrOutput { return v.Status }).(pulumi.StringPtrOutput)
}

// Target to match against for determining what to scan and how frequently
// Structure is documented below.
func (o PreventionDiscoveryConfigOutput) Targets() PreventionDiscoveryConfigTargetArrayOutput {
	return o.ApplyT(func(v *PreventionDiscoveryConfig) PreventionDiscoveryConfigTargetArrayOutput { return v.Targets }).(PreventionDiscoveryConfigTargetArrayOutput)
}

// Output only. The last update timestamp of a DiscoveryConfig.
func (o PreventionDiscoveryConfigOutput) UpdateTime() pulumi.StringOutput {
	return o.ApplyT(func(v *PreventionDiscoveryConfig) pulumi.StringOutput { return v.UpdateTime }).(pulumi.StringOutput)
}

type PreventionDiscoveryConfigArrayOutput struct{ *pulumi.OutputState }

func (PreventionDiscoveryConfigArrayOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*PreventionDiscoveryConfig)(nil)).Elem()
}

func (o PreventionDiscoveryConfigArrayOutput) ToPreventionDiscoveryConfigArrayOutput() PreventionDiscoveryConfigArrayOutput {
	return o
}

func (o PreventionDiscoveryConfigArrayOutput) ToPreventionDiscoveryConfigArrayOutputWithContext(ctx context.Context) PreventionDiscoveryConfigArrayOutput {
	return o
}

func (o PreventionDiscoveryConfigArrayOutput) Index(i pulumi.IntInput) PreventionDiscoveryConfigOutput {
	return pulumi.All(o, i).ApplyT(func(vs []interface{}) *PreventionDiscoveryConfig {
		return vs[0].([]*PreventionDiscoveryConfig)[vs[1].(int)]
	}).(PreventionDiscoveryConfigOutput)
}

type PreventionDiscoveryConfigMapOutput struct{ *pulumi.OutputState }

func (PreventionDiscoveryConfigMapOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*PreventionDiscoveryConfig)(nil)).Elem()
}

func (o PreventionDiscoveryConfigMapOutput) ToPreventionDiscoveryConfigMapOutput() PreventionDiscoveryConfigMapOutput {
	return o
}

func (o PreventionDiscoveryConfigMapOutput) ToPreventionDiscoveryConfigMapOutputWithContext(ctx context.Context) PreventionDiscoveryConfigMapOutput {
	return o
}

func (o PreventionDiscoveryConfigMapOutput) MapIndex(k pulumi.StringInput) PreventionDiscoveryConfigOutput {
	return pulumi.All(o, k).ApplyT(func(vs []interface{}) *PreventionDiscoveryConfig {
		return vs[0].(map[string]*PreventionDiscoveryConfig)[vs[1].(string)]
	}).(PreventionDiscoveryConfigOutput)
}

func init() {
	pulumi.RegisterInputType(reflect.TypeOf((*PreventionDiscoveryConfigInput)(nil)).Elem(), &PreventionDiscoveryConfig{})
	pulumi.RegisterInputType(reflect.TypeOf((*PreventionDiscoveryConfigArrayInput)(nil)).Elem(), PreventionDiscoveryConfigArray{})
	pulumi.RegisterInputType(reflect.TypeOf((*PreventionDiscoveryConfigMapInput)(nil)).Elem(), PreventionDiscoveryConfigMap{})
	pulumi.RegisterOutputType(PreventionDiscoveryConfigOutput{})
	pulumi.RegisterOutputType(PreventionDiscoveryConfigArrayOutput{})
	pulumi.RegisterOutputType(PreventionDiscoveryConfigMapOutput{})
}
