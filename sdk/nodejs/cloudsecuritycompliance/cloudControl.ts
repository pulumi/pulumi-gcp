// *** WARNING: this file was generated by pulumi-language-nodejs. ***
// *** Do not edit by hand unless you're certain you know what you are doing! ***

import * as pulumi from "@pulumi/pulumi";
import * as inputs from "../types/input";
import * as outputs from "../types/output";
import * as utilities from "../utilities";

/**
 * Cloud controls are the building blocks that make up frameworks. Each cloud control is a unit encapsulating various platform-specific logic for prevention, detection, and audit.
 *
 * To get more information about CloudControl, see:
 *
 * * [API documentation](https://docs.cloud.google.com/security-command-center/docs/reference/cloudsecuritycompliance/rest/v1/organizations.locations.cloudControls)
 *
 * ## Example Usage
 *
 * ### Cloudsecuritycompliance Cloudcontrol Basic
 *
 * ```typescript
 * import * as pulumi from "@pulumi/pulumi";
 * import * as gcp from "@pulumi/gcp";
 *
 * const example = new gcp.cloudsecuritycompliance.CloudControl("example", {
 *     organization: "123456789",
 *     location: "global",
 *     cloudControlId: "example-cloudcontrol",
 *     displayName: "TF test CloudControl Name",
 *     description: "A test cloud control for security compliance",
 *     categories: ["CC_CATEGORY_INFRASTRUCTURE"],
 *     severity: "HIGH",
 *     findingCategory: "SECURITY_POLICY",
 *     remediationSteps: "Review and update the security configuration according to best practices.",
 *     supportedCloudProviders: ["GCP"],
 *     rules: [{
 *         description: "Ensure compute instances have secure boot enabled",
 *         ruleActionTypes: ["RULE_ACTION_TYPE_DETECTIVE"],
 *         celExpression: {
 *             expression: "resource.data.shieldedInstanceConfig.enableSecureBoot == true",
 *             resourceTypesValues: {
 *                 values: ["compute.googleapis.com/Instance"],
 *             },
 *         },
 *     }],
 *     parameterSpecs: [
 *         {
 *             name: "location",
 *             displayName: "Resource Location",
 *             description: "The location where the resource should be deployed",
 *             valueType: "STRING",
 *             isRequired: true,
 *             defaultValue: {
 *                 stringValue: "us-central1",
 *             },
 *             validation: {
 *                 regexpPattern: {
 *                     pattern: "^[a-z]+-[a-z]+[0-9]$",
 *                 },
 *             },
 *         },
 *         {
 *             name: "enable_secure_boot",
 *             displayName: "Enable Secure Boot",
 *             description: "Whether to enable secure boot for instances",
 *             valueType: "BOOLEAN",
 *             isRequired: true,
 *             defaultValue: {
 *                 boolValue: true,
 *             },
 *             substitutionRules: [{
 *                 attributeSubstitutionRule: {
 *                     attribute: "rules[0].cel_expression.expression",
 *                 },
 *             }],
 *             validation: {
 *                 allowedValues: {
 *                     values: [{
 *                         boolValue: true,
 *                     }],
 *                 },
 *             },
 *         },
 *         {
 *             name: "max_instances",
 *             displayName: "Maximum Instances",
 *             description: "Maximum number of instances allowed",
 *             valueType: "NUMBER",
 *             isRequired: false,
 *             defaultValue: {
 *                 numberValue: 10,
 *             },
 *             substitutionRules: [{
 *                 placeholderSubstitutionRule: {
 *                     attribute: "rules[0].description",
 *                 },
 *             }],
 *             validation: {
 *                 intRange: {
 *                     min: "1",
 *                     max: "100",
 *                 },
 *             },
 *         },
 *         {
 *             name: "allowed_regions",
 *             displayName: "Allowed Regions",
 *             description: "List of regions where resources can be deployed",
 *             valueType: "STRINGLIST",
 *             isRequired: true,
 *             defaultValue: {
 *                 stringListValue: {
 *                     values: [
 *                         "us-central1",
 *                         "us-east1",
 *                         "us-west1",
 *                     ],
 *                 },
 *             },
 *             validation: {
 *                 allowedValues: {
 *                     values: [
 *                         {
 *                             stringListValue: {
 *                                 values: [
 *                                     "us-central1",
 *                                     "us-east1",
 *                                 ],
 *                             },
 *                         },
 *                         {
 *                             stringListValue: {
 *                                 values: [
 *                                     "us-west1",
 *                                     "us-west2",
 *                                 ],
 *                             },
 *                         },
 *                     ],
 *                 },
 *             },
 *         },
 *         {
 *             name: "environment_type",
 *             displayName: "Environment Type",
 *             description: "The type of environment",
 *             valueType: "STRING",
 *             isRequired: true,
 *             defaultValue: {
 *                 stringValue: "production",
 *             },
 *             validation: {
 *                 allowedValues: {
 *                     values: [
 *                         {
 *                             stringValue: "production",
 *                         },
 *                         {
 *                             stringValue: "staging",
 *                         },
 *                         {
 *                             numberValue: 1,
 *                         },
 *                     ],
 *                 },
 *             },
 *         },
 *     ],
 * });
 * ```
 *
 * ## Import
 *
 * CloudControl can be imported using any of these accepted formats:
 *
 * * `organizations/{{organization}}/locations/{{location}}/cloudControls/{{cloud_control_id}}`
 *
 * * `{{organization}}/{{location}}/{{cloud_control_id}}`
 *
 * When using the `pulumi import` command, CloudControl can be imported using one of the formats above. For example:
 *
 * ```sh
 * $ pulumi import gcp:cloudsecuritycompliance/cloudControl:CloudControl default organizations/{{organization}}/locations/{{location}}/cloudControls/{{cloud_control_id}}
 * ```
 *
 * ```sh
 * $ pulumi import gcp:cloudsecuritycompliance/cloudControl:CloudControl default {{organization}}/{{location}}/{{cloud_control_id}}
 * ```
 */
export class CloudControl extends pulumi.CustomResource {
    /**
     * Get an existing CloudControl resource's state with the given name, ID, and optional extra
     * properties used to qualify the lookup.
     *
     * @param name The _unique_ name of the resulting resource.
     * @param id The _unique_ provider ID of the resource to lookup.
     * @param state Any extra arguments used during the lookup.
     * @param opts Optional settings to control the behavior of the CustomResource.
     */
    public static get(name: string, id: pulumi.Input<pulumi.ID>, state?: CloudControlState, opts?: pulumi.CustomResourceOptions): CloudControl {
        return new CloudControl(name, <any>state, { ...opts, id: id });
    }

    /** @internal */
    public static readonly __pulumiType = 'gcp:cloudsecuritycompliance/cloudControl:CloudControl';

    /**
     * Returns true if the given object is an instance of CloudControl.  This is designed to work even
     * when multiple copies of the Pulumi SDK have been loaded into the same process.
     */
    public static isInstance(obj: any): obj is CloudControl {
        if (obj === undefined || obj === null) {
            return false;
        }
        return obj['__pulumiType'] === CloudControl.__pulumiType;
    }

    /**
     * The categories of the cloud control.
     */
    declare public readonly categories: pulumi.Output<string[] | undefined>;
    /**
     * ID of the CloudControl.
     * This is the last segment of the CloudControl resource name.
     * Format: `^a-zA-Z{0,61}[a-zA-Z0-9]$`.
     */
    declare public readonly cloudControlId: pulumi.Output<string>;
    /**
     * The last updated time of the cloud control.
     * The createTime is used because a new CC is created whenever we update an
     * existing CC.
     */
    declare public /*out*/ readonly createTime: pulumi.Output<string>;
    /**
     * A description of the cloud control. The maximum length is 2000 characters.
     */
    declare public readonly description: pulumi.Output<string | undefined>;
    /**
     * The display name of the cloud control. The maximum length is 200
     * characters.
     */
    declare public readonly displayName: pulumi.Output<string | undefined>;
    /**
     * The findingCategory of the cloud control. The maximum length is 255
     * characters.
     */
    declare public readonly findingCategory: pulumi.Output<string | undefined>;
    /**
     * Resource ID segment making up resource `name`. It identifies the resource within its parent collection as described in https://google.aip.dev/122. Currently, only "global" is supported as a location.
     */
    declare public readonly location: pulumi.Output<string>;
    /**
     * Major revision of the cloud control incremented in ascending order.
     */
    declare public /*out*/ readonly majorRevisionId: pulumi.Output<string>;
    /**
     * Identifier. The resource name of the cloud control.
     * Format:
     * organizations/{organization}/locations/{location}/cloudControls/{cloud_control_id}
     */
    declare public /*out*/ readonly name: pulumi.Output<string>;
    /**
     * Resource ID segment making up resource `name`. It identifies the resource within its parent collection as described in https://google.aip.dev/122.
     */
    declare public readonly organization: pulumi.Output<string>;
    /**
     * The parameter spec of the cloud control.
     * Structure is documented below.
     */
    declare public readonly parameterSpecs: pulumi.Output<outputs.cloudsecuritycompliance.CloudControlParameterSpec[] | undefined>;
    /**
     * The Frameworks that include this CloudControl
     */
    declare public /*out*/ readonly relatedFrameworks: pulumi.Output<string[]>;
    /**
     * The remediation steps for the findings generated by the cloud control. The
     * maximum length is 400 characters.
     */
    declare public readonly remediationSteps: pulumi.Output<string | undefined>;
    /**
     * The Policy to be enforced to prevent/detect resource non-compliance.
     * Structure is documented below.
     */
    declare public readonly rules: pulumi.Output<outputs.cloudsecuritycompliance.CloudControlRule[] | undefined>;
    /**
     * Possible values:
     * CRITICAL
     * HIGH
     * MEDIUM
     * LOW
     */
    declare public readonly severity: pulumi.Output<string | undefined>;
    /**
     * cloud providers supported
     */
    declare public readonly supportedCloudProviders: pulumi.Output<string[] | undefined>;
    /**
     * The supported enforcement mode of the cloud control. Default is DETECTIVE.
     */
    declare public /*out*/ readonly supportedEnforcementModes: pulumi.Output<string[]>;
    /**
     * target resource types supported by the CloudControl.
     */
    declare public /*out*/ readonly supportedTargetResourceTypes: pulumi.Output<string[]>;

    /**
     * Create a CloudControl resource with the given unique name, arguments, and options.
     *
     * @param name The _unique_ name of the resource.
     * @param args The arguments to use to populate this resource's properties.
     * @param opts A bag of options that control this resource's behavior.
     */
    constructor(name: string, args: CloudControlArgs, opts?: pulumi.CustomResourceOptions)
    constructor(name: string, argsOrState?: CloudControlArgs | CloudControlState, opts?: pulumi.CustomResourceOptions) {
        let resourceInputs: pulumi.Inputs = {};
        opts = opts || {};
        if (opts.id) {
            const state = argsOrState as CloudControlState | undefined;
            resourceInputs["categories"] = state?.categories;
            resourceInputs["cloudControlId"] = state?.cloudControlId;
            resourceInputs["createTime"] = state?.createTime;
            resourceInputs["description"] = state?.description;
            resourceInputs["displayName"] = state?.displayName;
            resourceInputs["findingCategory"] = state?.findingCategory;
            resourceInputs["location"] = state?.location;
            resourceInputs["majorRevisionId"] = state?.majorRevisionId;
            resourceInputs["name"] = state?.name;
            resourceInputs["organization"] = state?.organization;
            resourceInputs["parameterSpecs"] = state?.parameterSpecs;
            resourceInputs["relatedFrameworks"] = state?.relatedFrameworks;
            resourceInputs["remediationSteps"] = state?.remediationSteps;
            resourceInputs["rules"] = state?.rules;
            resourceInputs["severity"] = state?.severity;
            resourceInputs["supportedCloudProviders"] = state?.supportedCloudProviders;
            resourceInputs["supportedEnforcementModes"] = state?.supportedEnforcementModes;
            resourceInputs["supportedTargetResourceTypes"] = state?.supportedTargetResourceTypes;
        } else {
            const args = argsOrState as CloudControlArgs | undefined;
            if (args?.cloudControlId === undefined && !opts.urn) {
                throw new Error("Missing required property 'cloudControlId'");
            }
            if (args?.location === undefined && !opts.urn) {
                throw new Error("Missing required property 'location'");
            }
            if (args?.organization === undefined && !opts.urn) {
                throw new Error("Missing required property 'organization'");
            }
            resourceInputs["categories"] = args?.categories;
            resourceInputs["cloudControlId"] = args?.cloudControlId;
            resourceInputs["description"] = args?.description;
            resourceInputs["displayName"] = args?.displayName;
            resourceInputs["findingCategory"] = args?.findingCategory;
            resourceInputs["location"] = args?.location;
            resourceInputs["organization"] = args?.organization;
            resourceInputs["parameterSpecs"] = args?.parameterSpecs;
            resourceInputs["remediationSteps"] = args?.remediationSteps;
            resourceInputs["rules"] = args?.rules;
            resourceInputs["severity"] = args?.severity;
            resourceInputs["supportedCloudProviders"] = args?.supportedCloudProviders;
            resourceInputs["createTime"] = undefined /*out*/;
            resourceInputs["majorRevisionId"] = undefined /*out*/;
            resourceInputs["name"] = undefined /*out*/;
            resourceInputs["relatedFrameworks"] = undefined /*out*/;
            resourceInputs["supportedEnforcementModes"] = undefined /*out*/;
            resourceInputs["supportedTargetResourceTypes"] = undefined /*out*/;
        }
        opts = pulumi.mergeOptions(utilities.resourceOptsDefaults(), opts);
        super(CloudControl.__pulumiType, name, resourceInputs, opts);
    }
}

/**
 * Input properties used for looking up and filtering CloudControl resources.
 */
export interface CloudControlState {
    /**
     * The categories of the cloud control.
     */
    categories?: pulumi.Input<pulumi.Input<string>[]>;
    /**
     * ID of the CloudControl.
     * This is the last segment of the CloudControl resource name.
     * Format: `^a-zA-Z{0,61}[a-zA-Z0-9]$`.
     */
    cloudControlId?: pulumi.Input<string>;
    /**
     * The last updated time of the cloud control.
     * The createTime is used because a new CC is created whenever we update an
     * existing CC.
     */
    createTime?: pulumi.Input<string>;
    /**
     * A description of the cloud control. The maximum length is 2000 characters.
     */
    description?: pulumi.Input<string>;
    /**
     * The display name of the cloud control. The maximum length is 200
     * characters.
     */
    displayName?: pulumi.Input<string>;
    /**
     * The findingCategory of the cloud control. The maximum length is 255
     * characters.
     */
    findingCategory?: pulumi.Input<string>;
    /**
     * Resource ID segment making up resource `name`. It identifies the resource within its parent collection as described in https://google.aip.dev/122. Currently, only "global" is supported as a location.
     */
    location?: pulumi.Input<string>;
    /**
     * Major revision of the cloud control incremented in ascending order.
     */
    majorRevisionId?: pulumi.Input<string>;
    /**
     * Identifier. The resource name of the cloud control.
     * Format:
     * organizations/{organization}/locations/{location}/cloudControls/{cloud_control_id}
     */
    name?: pulumi.Input<string>;
    /**
     * Resource ID segment making up resource `name`. It identifies the resource within its parent collection as described in https://google.aip.dev/122.
     */
    organization?: pulumi.Input<string>;
    /**
     * The parameter spec of the cloud control.
     * Structure is documented below.
     */
    parameterSpecs?: pulumi.Input<pulumi.Input<inputs.cloudsecuritycompliance.CloudControlParameterSpec>[]>;
    /**
     * The Frameworks that include this CloudControl
     */
    relatedFrameworks?: pulumi.Input<pulumi.Input<string>[]>;
    /**
     * The remediation steps for the findings generated by the cloud control. The
     * maximum length is 400 characters.
     */
    remediationSteps?: pulumi.Input<string>;
    /**
     * The Policy to be enforced to prevent/detect resource non-compliance.
     * Structure is documented below.
     */
    rules?: pulumi.Input<pulumi.Input<inputs.cloudsecuritycompliance.CloudControlRule>[]>;
    /**
     * Possible values:
     * CRITICAL
     * HIGH
     * MEDIUM
     * LOW
     */
    severity?: pulumi.Input<string>;
    /**
     * cloud providers supported
     */
    supportedCloudProviders?: pulumi.Input<pulumi.Input<string>[]>;
    /**
     * The supported enforcement mode of the cloud control. Default is DETECTIVE.
     */
    supportedEnforcementModes?: pulumi.Input<pulumi.Input<string>[]>;
    /**
     * target resource types supported by the CloudControl.
     */
    supportedTargetResourceTypes?: pulumi.Input<pulumi.Input<string>[]>;
}

/**
 * The set of arguments for constructing a CloudControl resource.
 */
export interface CloudControlArgs {
    /**
     * The categories of the cloud control.
     */
    categories?: pulumi.Input<pulumi.Input<string>[]>;
    /**
     * ID of the CloudControl.
     * This is the last segment of the CloudControl resource name.
     * Format: `^a-zA-Z{0,61}[a-zA-Z0-9]$`.
     */
    cloudControlId: pulumi.Input<string>;
    /**
     * A description of the cloud control. The maximum length is 2000 characters.
     */
    description?: pulumi.Input<string>;
    /**
     * The display name of the cloud control. The maximum length is 200
     * characters.
     */
    displayName?: pulumi.Input<string>;
    /**
     * The findingCategory of the cloud control. The maximum length is 255
     * characters.
     */
    findingCategory?: pulumi.Input<string>;
    /**
     * Resource ID segment making up resource `name`. It identifies the resource within its parent collection as described in https://google.aip.dev/122. Currently, only "global" is supported as a location.
     */
    location: pulumi.Input<string>;
    /**
     * Resource ID segment making up resource `name`. It identifies the resource within its parent collection as described in https://google.aip.dev/122.
     */
    organization: pulumi.Input<string>;
    /**
     * The parameter spec of the cloud control.
     * Structure is documented below.
     */
    parameterSpecs?: pulumi.Input<pulumi.Input<inputs.cloudsecuritycompliance.CloudControlParameterSpec>[]>;
    /**
     * The remediation steps for the findings generated by the cloud control. The
     * maximum length is 400 characters.
     */
    remediationSteps?: pulumi.Input<string>;
    /**
     * The Policy to be enforced to prevent/detect resource non-compliance.
     * Structure is documented below.
     */
    rules?: pulumi.Input<pulumi.Input<inputs.cloudsecuritycompliance.CloudControlRule>[]>;
    /**
     * Possible values:
     * CRITICAL
     * HIGH
     * MEDIUM
     * LOW
     */
    severity?: pulumi.Input<string>;
    /**
     * cloud providers supported
     */
    supportedCloudProviders?: pulumi.Input<pulumi.Input<string>[]>;
}
