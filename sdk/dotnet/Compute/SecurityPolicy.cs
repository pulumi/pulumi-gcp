// *** WARNING: this file was generated by pulumi-language-dotnet. ***
// *** Do not edit by hand unless you're certain you know what you are doing! ***

using System;
using System.Collections.Generic;
using System.Collections.Immutable;
using System.Threading.Tasks;
using Pulumi.Serialization;

namespace Pulumi.Gcp.Compute
{
    /// <summary>
    /// A Security Policy defines an IP blacklist or whitelist that protects load balanced Google Cloud services by denying or permitting traffic from specified IP ranges. For more information
    /// see the [official documentation](https://cloud.google.com/armor/docs/configure-security-policies)
    /// and the [API](https://cloud.google.com/compute/docs/reference/rest/beta/securityPolicies).
    /// 
    /// Security Policy is used by google_compute_backend_service.
    /// 
    /// ## Example Usage
    /// 
    /// ```csharp
    /// using System.Collections.Generic;
    /// using System.Linq;
    /// using Pulumi;
    /// using Gcp = Pulumi.Gcp;
    /// 
    /// return await Deployment.RunAsync(() =&gt; 
    /// {
    ///     var policy = new Gcp.Compute.SecurityPolicy("policy", new()
    ///     {
    ///         Name = "my-policy",
    ///         Rules = new[]
    ///         {
    ///             new Gcp.Compute.Inputs.SecurityPolicyRuleArgs
    ///             {
    ///                 Action = "deny(403)",
    ///                 Priority = 1000,
    ///                 Match = new Gcp.Compute.Inputs.SecurityPolicyRuleMatchArgs
    ///                 {
    ///                     VersionedExpr = "SRC_IPS_V1",
    ///                     Config = new Gcp.Compute.Inputs.SecurityPolicyRuleMatchConfigArgs
    ///                     {
    ///                         SrcIpRanges = new[]
    ///                         {
    ///                             "9.9.9.0/24",
    ///                         },
    ///                     },
    ///                 },
    ///                 Description = "Deny access to IPs in 9.9.9.0/24",
    ///             },
    ///             new Gcp.Compute.Inputs.SecurityPolicyRuleArgs
    ///             {
    ///                 Action = "allow",
    ///                 Priority = 2147483647,
    ///                 Match = new Gcp.Compute.Inputs.SecurityPolicyRuleMatchArgs
    ///                 {
    ///                     VersionedExpr = "SRC_IPS_V1",
    ///                     Config = new Gcp.Compute.Inputs.SecurityPolicyRuleMatchConfigArgs
    ///                     {
    ///                         SrcIpRanges = new[]
    ///                         {
    ///                             "*",
    ///                         },
    ///                     },
    ///                 },
    ///                 Description = "default rule",
    ///             },
    ///         },
    ///     });
    /// 
    /// });
    /// ```
    /// 
    /// ### With ReCAPTCHA Configuration Options
    /// 
    /// ```csharp
    /// using System.Collections.Generic;
    /// using System.Linq;
    /// using Pulumi;
    /// using Gcp = Pulumi.Gcp;
    /// 
    /// return await Deployment.RunAsync(() =&gt; 
    /// {
    ///     var primary = new Gcp.Recaptcha.EnterpriseKey("primary", new()
    ///     {
    ///         DisplayName = "display-name",
    ///         Labels = 
    ///         {
    ///             { "label-one", "value-one" },
    ///         },
    ///         Project = "my-project-name",
    ///         WebSettings = new Gcp.Recaptcha.Inputs.EnterpriseKeyWebSettingsArgs
    ///         {
    ///             IntegrationType = "INVISIBLE",
    ///             AllowAllDomains = true,
    ///             AllowedDomains = new[]
    ///             {
    ///                 "localhost",
    ///             },
    ///         },
    ///     });
    /// 
    ///     var policy = new Gcp.Compute.SecurityPolicy("policy", new()
    ///     {
    ///         Name = "my-policy",
    ///         Description = "basic security policy",
    ///         Type = "CLOUD_ARMOR",
    ///         RecaptchaOptionsConfig = new Gcp.Compute.Inputs.SecurityPolicyRecaptchaOptionsConfigArgs
    ///         {
    ///             RedirectSiteKey = primary.Name,
    ///         },
    ///     });
    /// 
    /// });
    /// ```
    /// 
    /// ### With Header Actions
    /// 
    /// ```csharp
    /// using System.Collections.Generic;
    /// using System.Linq;
    /// using Pulumi;
    /// using Gcp = Pulumi.Gcp;
    /// 
    /// return await Deployment.RunAsync(() =&gt; 
    /// {
    ///     var policy = new Gcp.Compute.SecurityPolicy("policy", new()
    ///     {
    ///         Name = "my-policy",
    ///         Rules = new[]
    ///         {
    ///             new Gcp.Compute.Inputs.SecurityPolicyRuleArgs
    ///             {
    ///                 Action = "allow",
    ///                 Priority = 2147483647,
    ///                 Match = new Gcp.Compute.Inputs.SecurityPolicyRuleMatchArgs
    ///                 {
    ///                     VersionedExpr = "SRC_IPS_V1",
    ///                     Config = new Gcp.Compute.Inputs.SecurityPolicyRuleMatchConfigArgs
    ///                     {
    ///                         SrcIpRanges = new[]
    ///                         {
    ///                             "*",
    ///                         },
    ///                     },
    ///                 },
    ///                 Description = "default rule",
    ///             },
    ///             new Gcp.Compute.Inputs.SecurityPolicyRuleArgs
    ///             {
    ///                 Action = "allow",
    ///                 Priority = 1000,
    ///                 Match = new Gcp.Compute.Inputs.SecurityPolicyRuleMatchArgs
    ///                 {
    ///                     Expr = new Gcp.Compute.Inputs.SecurityPolicyRuleMatchExprArgs
    ///                     {
    ///                         Expression = "request.path.matches(\"/login.html\") &amp;&amp; token.recaptcha_session.score &lt; 0.2",
    ///                     },
    ///                 },
    ///                 HeaderAction = new Gcp.Compute.Inputs.SecurityPolicyRuleHeaderActionArgs
    ///                 {
    ///                     RequestHeadersToAdds = new[]
    ///                     {
    ///                         new Gcp.Compute.Inputs.SecurityPolicyRuleHeaderActionRequestHeadersToAddArgs
    ///                         {
    ///                             HeaderName = "reCAPTCHA-Warning",
    ///                             HeaderValue = "high",
    ///                         },
    ///                         new Gcp.Compute.Inputs.SecurityPolicyRuleHeaderActionRequestHeadersToAddArgs
    ///                         {
    ///                             HeaderName = "X-Resource",
    ///                             HeaderValue = "test",
    ///                         },
    ///                     },
    ///                 },
    ///             },
    ///         },
    ///     });
    /// 
    /// });
    /// ```
    /// 
    /// ### With EnforceOnKey Value As Empty String
    /// A scenario example that won't cause any conflict between `enforce_on_key` and `enforce_on_key_configs`, because `enforce_on_key` was specified as an empty string:
    /// 
    /// ```csharp
    /// using System.Collections.Generic;
    /// using System.Linq;
    /// using Pulumi;
    /// using Gcp = Pulumi.Gcp;
    /// 
    /// return await Deployment.RunAsync(() =&gt; 
    /// {
    ///     var policy = new Gcp.Compute.SecurityPolicy("policy", new()
    ///     {
    ///         Name = "%s",
    ///         Description = "throttle rule with enforce_on_key_configs",
    ///         Rules = new[]
    ///         {
    ///             new Gcp.Compute.Inputs.SecurityPolicyRuleArgs
    ///             {
    ///                 Action = "throttle",
    ///                 Priority = 2147483647,
    ///                 Match = new Gcp.Compute.Inputs.SecurityPolicyRuleMatchArgs
    ///                 {
    ///                     VersionedExpr = "SRC_IPS_V1",
    ///                     Config = new Gcp.Compute.Inputs.SecurityPolicyRuleMatchConfigArgs
    ///                     {
    ///                         SrcIpRanges = new[]
    ///                         {
    ///                             "*",
    ///                         },
    ///                     },
    ///                 },
    ///                 Description = "default rule",
    ///                 RateLimitOptions = new Gcp.Compute.Inputs.SecurityPolicyRuleRateLimitOptionsArgs
    ///                 {
    ///                     ConformAction = "allow",
    ///                     ExceedAction = "redirect",
    ///                     EnforceOnKey = "",
    ///                     EnforceOnKeyConfigs = new[]
    ///                     {
    ///                         new Gcp.Compute.Inputs.SecurityPolicyRuleRateLimitOptionsEnforceOnKeyConfigArgs
    ///                         {
    ///                             EnforceOnKeyType = "IP",
    ///                         },
    ///                     },
    ///                     ExceedRedirectOptions = new Gcp.Compute.Inputs.SecurityPolicyRuleRateLimitOptionsExceedRedirectOptionsArgs
    ///                     {
    ///                         Type = "EXTERNAL_302",
    ///                         Target = "&lt;https://www.example.com&gt;",
    ///                     },
    ///                     RateLimitThreshold = new Gcp.Compute.Inputs.SecurityPolicyRuleRateLimitOptionsRateLimitThresholdArgs
    ///                     {
    ///                         Count = 10,
    ///                         IntervalSec = 60,
    ///                     },
    ///                 },
    ///             },
    ///         },
    ///     });
    /// 
    /// });
    /// ```
    /// 
    /// ## Import
    /// 
    /// Security policies can be imported using any of these accepted formats:
    /// 
    /// * `projects/{{project}}/global/securityPolicies/{{name}}`
    /// 
    /// * `{{project}}/{{name}}`
    /// 
    /// * `{{name}}`
    /// 
    /// When using the `pulumi import` command, security policies can be imported using one of the formats above. For example:
    /// 
    /// ```sh
    /// $ pulumi import gcp:compute/securityPolicy:SecurityPolicy default projects/{{project}}/global/securityPolicies/{{name}}
    /// ```
    /// 
    /// ```sh
    /// $ pulumi import gcp:compute/securityPolicy:SecurityPolicy default {{project}}/{{name}}
    /// ```
    /// 
    /// ```sh
    /// $ pulumi import gcp:compute/securityPolicy:SecurityPolicy default {{name}}
    /// ```
    /// </summary>
    [GcpResourceType("gcp:compute/securityPolicy:SecurityPolicy")]
    public partial class SecurityPolicy : global::Pulumi.CustomResource
    {
        /// <summary>
        /// Configuration for [Google Cloud Armor Adaptive Protection](https://cloud.google.com/armor/docs/adaptive-protection-overview?hl=en). Structure is documented below.
        /// </summary>
        [Output("adaptiveProtectionConfig")]
        public Output<Outputs.SecurityPolicyAdaptiveProtectionConfig?> AdaptiveProtectionConfig { get; private set; } = null!;

        /// <summary>
        /// [Advanced Configuration Options](https://cloud.google.com/armor/docs/security-policy-overview#json-parsing).
        /// Structure is documented below.
        /// </summary>
        [Output("advancedOptionsConfig")]
        public Output<Outputs.SecurityPolicyAdvancedOptionsConfig> AdvancedOptionsConfig { get; private set; } = null!;

        /// <summary>
        /// An optional description of this security policy. Max size is 2048.
        /// </summary>
        [Output("description")]
        public Output<string?> Description { get; private set; } = null!;

        /// <summary>
        /// Fingerprint of this resource.
        /// </summary>
        [Output("fingerprint")]
        public Output<string> Fingerprint { get; private set; } = null!;

        /// <summary>
        /// The name of the security policy.
        /// 
        /// - - -
        /// </summary>
        [Output("name")]
        public Output<string> Name { get; private set; } = null!;

        /// <summary>
        /// The project in which the resource belongs. If it
        /// is not provided, the provider project is used.
        /// </summary>
        [Output("project")]
        public Output<string> Project { get; private set; } = null!;

        /// <summary>
        /// [reCAPTCHA Configuration Options](https://cloud.google.com/armor/docs/configure-security-policies?hl=en#use_a_manual_challenge_to_distinguish_between_human_or_automated_clients). Structure is documented below.
        /// </summary>
        [Output("recaptchaOptionsConfig")]
        public Output<Outputs.SecurityPolicyRecaptchaOptionsConfig?> RecaptchaOptionsConfig { get; private set; } = null!;

        /// <summary>
        /// The set of rules that belong to this policy. There must always be a default
        /// rule (rule with priority 2147483647 and match "\*"). If no rules are provided when creating a
        /// security policy, a default rule with action "allow" will be added. Structure is documented below.
        /// </summary>
        [Output("rules")]
        public Output<ImmutableArray<Outputs.SecurityPolicyRule>> Rules { get; private set; } = null!;

        /// <summary>
        /// The URI of the created resource.
        /// </summary>
        [Output("selfLink")]
        public Output<string> SelfLink { get; private set; } = null!;

        /// <summary>
        /// The type indicates the intended use of the security policy. This field can be set only at resource creation time.
        /// * `CLOUD_ARMOR` - Cloud Armor backend security policies can be configured to filter incoming HTTP requests targeting backend services.
        /// They filter requests before they hit the origin servers.
        /// * `CLOUD_ARMOR_EDGE` - Cloud Armor edge security policies can be configured to filter incoming HTTP requests targeting backend services
        /// (including Cloud CDN-enabled) as well as backend buckets (Cloud Storage).
        /// They filter requests before the request is served from Google's cache.
        /// * `CLOUD_ARMOR_INTERNAL_SERVICE` - Cloud Armor internal service policies can be configured to filter HTTP requests targeting services
        /// managed by Traffic Director in a service mesh. They filter requests before the request is served from the application.
        /// </summary>
        [Output("type")]
        public Output<string> Type { get; private set; } = null!;


        /// <summary>
        /// Create a SecurityPolicy resource with the given unique name, arguments, and options.
        /// </summary>
        ///
        /// <param name="name">The unique name of the resource</param>
        /// <param name="args">The arguments used to populate this resource's properties</param>
        /// <param name="options">A bag of options that control this resource's behavior</param>
        public SecurityPolicy(string name, SecurityPolicyArgs? args = null, CustomResourceOptions? options = null)
            : base("gcp:compute/securityPolicy:SecurityPolicy", name, args ?? new SecurityPolicyArgs(), MakeResourceOptions(options, ""))
        {
        }

        private SecurityPolicy(string name, Input<string> id, SecurityPolicyState? state = null, CustomResourceOptions? options = null)
            : base("gcp:compute/securityPolicy:SecurityPolicy", name, state, MakeResourceOptions(options, id))
        {
        }

        private static CustomResourceOptions MakeResourceOptions(CustomResourceOptions? options, Input<string>? id)
        {
            var defaultOptions = new CustomResourceOptions
            {
                Version = Utilities.Version,
            };
            var merged = CustomResourceOptions.Merge(defaultOptions, options);
            // Override the ID if one was specified for consistency with other language SDKs.
            merged.Id = id ?? merged.Id;
            return merged;
        }
        /// <summary>
        /// Get an existing SecurityPolicy resource's state with the given name, ID, and optional extra
        /// properties used to qualify the lookup.
        /// </summary>
        ///
        /// <param name="name">The unique name of the resulting resource.</param>
        /// <param name="id">The unique provider ID of the resource to lookup.</param>
        /// <param name="state">Any extra arguments used during the lookup.</param>
        /// <param name="options">A bag of options that control this resource's behavior</param>
        public static SecurityPolicy Get(string name, Input<string> id, SecurityPolicyState? state = null, CustomResourceOptions? options = null)
        {
            return new SecurityPolicy(name, id, state, options);
        }
    }

    public sealed class SecurityPolicyArgs : global::Pulumi.ResourceArgs
    {
        /// <summary>
        /// Configuration for [Google Cloud Armor Adaptive Protection](https://cloud.google.com/armor/docs/adaptive-protection-overview?hl=en). Structure is documented below.
        /// </summary>
        [Input("adaptiveProtectionConfig")]
        public Input<Inputs.SecurityPolicyAdaptiveProtectionConfigArgs>? AdaptiveProtectionConfig { get; set; }

        /// <summary>
        /// [Advanced Configuration Options](https://cloud.google.com/armor/docs/security-policy-overview#json-parsing).
        /// Structure is documented below.
        /// </summary>
        [Input("advancedOptionsConfig")]
        public Input<Inputs.SecurityPolicyAdvancedOptionsConfigArgs>? AdvancedOptionsConfig { get; set; }

        /// <summary>
        /// An optional description of this security policy. Max size is 2048.
        /// </summary>
        [Input("description")]
        public Input<string>? Description { get; set; }

        /// <summary>
        /// The name of the security policy.
        /// 
        /// - - -
        /// </summary>
        [Input("name")]
        public Input<string>? Name { get; set; }

        /// <summary>
        /// The project in which the resource belongs. If it
        /// is not provided, the provider project is used.
        /// </summary>
        [Input("project")]
        public Input<string>? Project { get; set; }

        /// <summary>
        /// [reCAPTCHA Configuration Options](https://cloud.google.com/armor/docs/configure-security-policies?hl=en#use_a_manual_challenge_to_distinguish_between_human_or_automated_clients). Structure is documented below.
        /// </summary>
        [Input("recaptchaOptionsConfig")]
        public Input<Inputs.SecurityPolicyRecaptchaOptionsConfigArgs>? RecaptchaOptionsConfig { get; set; }

        [Input("rules")]
        private InputList<Inputs.SecurityPolicyRuleArgs>? _rules;

        /// <summary>
        /// The set of rules that belong to this policy. There must always be a default
        /// rule (rule with priority 2147483647 and match "\*"). If no rules are provided when creating a
        /// security policy, a default rule with action "allow" will be added. Structure is documented below.
        /// </summary>
        public InputList<Inputs.SecurityPolicyRuleArgs> Rules
        {
            get => _rules ?? (_rules = new InputList<Inputs.SecurityPolicyRuleArgs>());
            set => _rules = value;
        }

        /// <summary>
        /// The type indicates the intended use of the security policy. This field can be set only at resource creation time.
        /// * `CLOUD_ARMOR` - Cloud Armor backend security policies can be configured to filter incoming HTTP requests targeting backend services.
        /// They filter requests before they hit the origin servers.
        /// * `CLOUD_ARMOR_EDGE` - Cloud Armor edge security policies can be configured to filter incoming HTTP requests targeting backend services
        /// (including Cloud CDN-enabled) as well as backend buckets (Cloud Storage).
        /// They filter requests before the request is served from Google's cache.
        /// * `CLOUD_ARMOR_INTERNAL_SERVICE` - Cloud Armor internal service policies can be configured to filter HTTP requests targeting services
        /// managed by Traffic Director in a service mesh. They filter requests before the request is served from the application.
        /// </summary>
        [Input("type")]
        public Input<string>? Type { get; set; }

        public SecurityPolicyArgs()
        {
        }
        public static new SecurityPolicyArgs Empty => new SecurityPolicyArgs();
    }

    public sealed class SecurityPolicyState : global::Pulumi.ResourceArgs
    {
        /// <summary>
        /// Configuration for [Google Cloud Armor Adaptive Protection](https://cloud.google.com/armor/docs/adaptive-protection-overview?hl=en). Structure is documented below.
        /// </summary>
        [Input("adaptiveProtectionConfig")]
        public Input<Inputs.SecurityPolicyAdaptiveProtectionConfigGetArgs>? AdaptiveProtectionConfig { get; set; }

        /// <summary>
        /// [Advanced Configuration Options](https://cloud.google.com/armor/docs/security-policy-overview#json-parsing).
        /// Structure is documented below.
        /// </summary>
        [Input("advancedOptionsConfig")]
        public Input<Inputs.SecurityPolicyAdvancedOptionsConfigGetArgs>? AdvancedOptionsConfig { get; set; }

        /// <summary>
        /// An optional description of this security policy. Max size is 2048.
        /// </summary>
        [Input("description")]
        public Input<string>? Description { get; set; }

        /// <summary>
        /// Fingerprint of this resource.
        /// </summary>
        [Input("fingerprint")]
        public Input<string>? Fingerprint { get; set; }

        /// <summary>
        /// The name of the security policy.
        /// 
        /// - - -
        /// </summary>
        [Input("name")]
        public Input<string>? Name { get; set; }

        /// <summary>
        /// The project in which the resource belongs. If it
        /// is not provided, the provider project is used.
        /// </summary>
        [Input("project")]
        public Input<string>? Project { get; set; }

        /// <summary>
        /// [reCAPTCHA Configuration Options](https://cloud.google.com/armor/docs/configure-security-policies?hl=en#use_a_manual_challenge_to_distinguish_between_human_or_automated_clients). Structure is documented below.
        /// </summary>
        [Input("recaptchaOptionsConfig")]
        public Input<Inputs.SecurityPolicyRecaptchaOptionsConfigGetArgs>? RecaptchaOptionsConfig { get; set; }

        [Input("rules")]
        private InputList<Inputs.SecurityPolicyRuleGetArgs>? _rules;

        /// <summary>
        /// The set of rules that belong to this policy. There must always be a default
        /// rule (rule with priority 2147483647 and match "\*"). If no rules are provided when creating a
        /// security policy, a default rule with action "allow" will be added. Structure is documented below.
        /// </summary>
        public InputList<Inputs.SecurityPolicyRuleGetArgs> Rules
        {
            get => _rules ?? (_rules = new InputList<Inputs.SecurityPolicyRuleGetArgs>());
            set => _rules = value;
        }

        /// <summary>
        /// The URI of the created resource.
        /// </summary>
        [Input("selfLink")]
        public Input<string>? SelfLink { get; set; }

        /// <summary>
        /// The type indicates the intended use of the security policy. This field can be set only at resource creation time.
        /// * `CLOUD_ARMOR` - Cloud Armor backend security policies can be configured to filter incoming HTTP requests targeting backend services.
        /// They filter requests before they hit the origin servers.
        /// * `CLOUD_ARMOR_EDGE` - Cloud Armor edge security policies can be configured to filter incoming HTTP requests targeting backend services
        /// (including Cloud CDN-enabled) as well as backend buckets (Cloud Storage).
        /// They filter requests before the request is served from Google's cache.
        /// * `CLOUD_ARMOR_INTERNAL_SERVICE` - Cloud Armor internal service policies can be configured to filter HTTP requests targeting services
        /// managed by Traffic Director in a service mesh. They filter requests before the request is served from the application.
        /// </summary>
        [Input("type")]
        public Input<string>? Type { get; set; }

        public SecurityPolicyState()
        {
        }
        public static new SecurityPolicyState Empty => new SecurityPolicyState();
    }
}
